%% from zpt07502.dat
salmon_pressure = [...
  2.7734e-04,  8.2020e-04,  1.7338e-03,  4.2167e-03,  9.4558e-03,...
  2.0262e-02,  4.2702e-02,  8.8683e-02,  1.8070e-01,  3.5719e-01,...
  6.6341e-01,  8.3218e-01,  1.0528e+00,  1.3522e+00,  1.7990e+00,...
  2.4032e+00,  3.2255e+00,  4.3492e+00,  5.8978e+00,  8.0103e+00,...
  1.0924e+01,  1.4885e+01,  2.0383e+01,  2.7980e+01,  3.8419e+01,...
  5.2772e+01,  7.2485e+01,  9.9527e+01,  1.3676e+02,  1.8921e+02,...
  2.6207e+02,  3.0589e+02,  3.5472e+02,  4.0971e+02,  4.7128e+02,...
  5.3979e+02,  6.1582e+02,  7.0071e+02,  7.9520e+02,  9.0153e+02,...
  1.0040e+03];
salmon_pressure = fliplr(salmon_pressure);

a01 = load('outfile_01.txt'); 
a02 = load('outfile_02.txt'); 
a03 = load('outfile_03.txt'); 
a04 = load('outfile_04.txt'); 
a05 = load('outfile_05.txt'); 
a06 = load('outfile_06.txt'); 
a07 = load('outfile_07.txt'); 
a08 = load('outfile_08.txt'); 
a09 = load('outfile_09.txt'); 
a10 = load('outfile_10.txt'); 
a11 = load('outfile_11.txt'); 
a12 = load('outfile_12.txt'); 

for iG = 1 : 57
  prof = ...
    [a01(:,iG) a02(:,iG) a03(:,iG) a04(:,iG) a05(:,iG) a06(:,iG) ...
     a07(:,iG) a08(:,iG) a09(:,iG) a10(:,iG) a11(:,iG) a12(:,iG)];
  mean_prof = mean(prof');
  std_prof  = std(prof');
  if iG == 2
    subplot(121); semilogy(mean_prof,salmon_pressure)
    subplot(122); semilogy(std_prof,salmon_pressure)
  else
    subplot(121); loglog(mean_prof,salmon_pressure)
    subplot(122); loglog(std_prof,salmon_pressure)
    end
  end

%% from ~/KCARTADATA/NLTE/UA> more glatm.dat  US Trp
pressure = [...
 1.013E+03, 9.040E+02, 8.050E+02, 7.150E+02, 6.330E+02,          ...
 5.590E+02, 4.920E+02, 4.320E+02, 3.780E+02, 3.290E+02,          ...
 2.860E+02, 2.470E+02, 2.130E+02, 1.820E+02, 1.560E+02,          ...
 1.320E+02, 1.110E+02, 9.370E+01, 7.890E+01, 6.660E+01,          ...
 5.650E+01, 4.800E+01, 4.090E+01, 3.500E+01, 3.000E+01,          ...
 2.570E+01, 1.763E+01, 1.220E+01, 8.520E+00, 6.000E+00,          ...
 4.260E+00, 3.050E+00, 2.200E+00, 1.590E+00, 1.160E+00,          ...
 8.540E-01, 4.560E-01, 2.390E-01, 1.210E-01, 5.800E-02,          ...
 2.600E-02, 1.100E-02, 4.400E-03, 1.720E-03, 6.880E-04,          ...
 2.890E-04, 1.300E-04, 6.470E-05, 3.600E-05, 2.250E-05           ];

T = [...
    299.70,    293.70,    287.70,    283.70,    277.00,          ...
    270.30,    263.60,    257.00,    250.30,    243.60,          ...
    237.00,    230.10,    223.60,    217.00,    210.30,          ...
    203.70,    197.00,    194.80,    198.80,    202.70,          ...
    206.70,    210.70,    214.60,    217.00,    219.20,          ...
    221.40,    227.00,    232.30,    237.70,    243.10,          ...
    248.50,    254.00,    259.40,    264.80,    269.60,          ...
    270.20,    263.40,    253.10,    236.00,    218.90,          ...
    201.80,    184.80,    177.10,    177.00,    184.30,          ...
    190.70,    212.00,    241.60,    299.70,    380.00           ];

CO2 = [...
 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02,          ...
 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02,          ...
 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02,          ...
 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02,          ...
 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02,          ...
 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02,          ...
 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02,          ...
 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02, 3.300E+02,          ...
 3.300E+02, 3.280E+02, 3.200E+02, 3.100E+02, 2.700E+02,          ...
 1.950E+02, 1.100E+02, 6.000E+01, 4.000E+01, 3.500E+01           ];

iG = 2;  %% CO2
iG = 46; %% HCOOH, which is HITRAN 32
iG = 22; %% HO2,   which is HITRAN 34
iG = 27; %% ClONO2 which is HITRAN 35
iG = 39; %% C2H4 , which is HITRAN 38

  prof = ...
    [a01(:,iG) a02(:,iG) a03(:,iG) a04(:,iG) a05(:,iG) a06(:,iG) ...
     a07(:,iG) a08(:,iG) a09(:,iG) a10(:,iG) a11(:,iG) a12(:,iG)];
  mean_prof = mean(prof');
  std_prof  = std(prof');
  subplot(131); semilogy(CO2,pressure); 
    set(gca,'ydir','reverse'); axis([0 400 1e-5 1020]); grid
  mzz = max(mean_prof)*1.01;
  subplot(132); semilogy(mean_prof,salmon_pressure); 
    set(gca,'ydir','reverse'); axis([0 mzz 1e-5 1020]); grid
  subplot(133); semilogy(std_prof,salmon_pressure);
    set(gca,'ydir','reverse'); axis([-1 1 1e-5 1020]); grid


clf
semilogy(mean_prof,salmon_pressure); 
set(gca,'ydir','reverse'); axis([0 mzz 1e-5 1020]); grid
title(num2str(iG))

%% now we want to put this into AIRS levels, and then intergrate to find 
%% column amounts
load refpro.mat
